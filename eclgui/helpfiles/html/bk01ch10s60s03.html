<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Options</title><link rel="stylesheet" href="eclipsehelp.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.1"><link rel="home" href="index.html" title="ECL Reference"><link rel="up" href="bk01ch10s60.html" title="JOIN"><link rel="prev" href="bk01ch10s60s02.html" title="Matching Logic - JOIN"><link rel="next" href="bk01ch10s60s04.html" title="Keyed Joins"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Options</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="bk01ch10s60s02.html">Prev</a>&nbsp;</td><th width="60%" align="center">JOIN</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="bk01ch10s60s04.html">Next</a></td></tr></table><hr></div><div class="sect2" title="Options"><div class="titlepage"><div><div><h3 class="title"><a name="Options"></a>Options</h3></div></div></div><p>The following <span class="emphasis"><em>joinflags</em></span><a class="indexterm" name="d4e8141"></a> options may be specified to determine exactly how the JOIN executes.</p><p><span class="bold"><strong>[</strong></span>,<span class="bold"><strong> PARTITION LEFT<a class="indexterm" name="d4e8146"></a> | PARTITION RIGHT<a class="indexterm" name="d4e8148"></a> | [MANY<a class="indexterm" name="d4e8150"></a>] LOOKUP<a class="indexterm" name="d4e8152"></a> [ FEW<a class="indexterm" name="d4e8154"></a>] ] | GROUPED<a class="indexterm" name="d4e8156"></a> | ALL<a class="indexterm" name="d4e8158"></a> |</strong></span><span class="bold"><strong> NOSORT<a class="indexterm" name="d4e8161"></a> [ ( </strong></span><span class="emphasis"><em>which</em></span><span class="bold"><strong> ) ] | KEYED<a class="indexterm" name="d4e8165"></a> [ (</strong></span><span class="emphasis"><em>index</em></span><span class="bold"><strong>) [, UNORDERED<a class="indexterm" name="d4e8169"></a> ] ] | LOCAL<a class="indexterm" name="d4e8171"></a> | HASH<a class="indexterm" name="d4e8173"></a> ]</strong></span><span class="bold"><strong>[</strong></span>,<span class="bold"><strong> KEEP<a class="indexterm" name="d4e8177"></a>(</strong></span><span class="emphasis"><em>n</em></span><span class="bold"><strong>) ] [</strong></span><span class="emphasis"><em>, </em></span><span class="bold"><strong>ATMOST<a class="indexterm" name="d4e8183"></a>(</strong></span><span class="emphasis"><em> </em></span><span class="bold"><strong>[</strong></span><span class="emphasis"><em> condition, </em></span><span class="bold"><strong>]</strong></span><span class="emphasis"><em> n </em></span><span class="bold"><strong>) ] [</strong></span><span class="emphasis"><em>, </em></span><span class="bold"><strong>LIMIT<a class="indexterm" name="d4e8193"></a>(</strong></span><span class="emphasis"><em> value </em></span><span class="bold"><strong>[, SKIP<a class="indexterm" name="d4e8197"></a>]</strong></span><span class="emphasis"><em> </em></span><span class="bold"><strong>) ]</strong></span><span class="bold"><strong>[</strong></span>,<span class="bold"><strong> SKEW<a class="indexterm" name="d4e8203"></a>(</strong></span><span class="emphasis"><em>limit </em></span><span class="bold"><strong>[</strong></span><span class="emphasis"><em>, target</em></span><span class="bold"><strong>] ) [, THRESHOLD<a class="indexterm" name="d4e8209"></a>( </strong></span><span class="emphasis"><em>size</em></span><span class="bold"><strong> ) ] ] [, PARALLEL<a class="indexterm" name="d4e8213"></a> ]</strong></span></p><div class="informaltable"><table border="0"><colgroup><col width="15%"><col width="85%"></colgroup><tbody><tr><td><span class="bold"><strong>PARTITION LEFT | RIGHT</strong></span></td><td>Specifies which recordset provides the partition points that determine how the records are sorted and distributed amongst the supercomputer nodes. PARTITION RIGHT specifies the <span class="emphasis"><em>rightrecset</em></span> while PARTITION LEFT specifies the <span class="emphasis"><em>leftrecset</em></span>. If omitted, PARTITION LEFT is the default.</td></tr><tr><td><span class="bold"><strong>[MANY] LOOKUP</strong></span></td><td>Specifies the <span class="emphasis"><em>rightrecset</em></span> is a relatively small file of lookup records that can be fully copied to every node. If MANY is not present, the <span class="emphasis"><em>rightrecset</em></span> records bear a Many to 0/1 relationship with the records in the <span class="emphasis"><em>leftrecset</em></span> (for each record in the <span class="emphasis"><em>leftrecset</em></span> there is at most 1 record in the <span class="emphasis"><em>rightrecset</em></span>). If MANY is present, the <span class="emphasis"><em>rightrecset</em></span> records bear a Many to 0/Many relationship with the records in the <span class="emphasis"><em>leftrecset</em></span>. This option allows the optimizer to avoid unnecessary sorting of the <span class="emphasis"><em>leftrecset</em></span>. Valid only for inner, LEFT OUTER, or LEFT ONLY <span class="emphasis"><em>jointypes</em></span>. The ATMOST, LIMIT, and KEEP options are supported in conjunction with MANY LOOKUP.</td></tr><tr><td><span class="bold"><strong>FEW</strong></span></td><td>Specifies the LOOKUP <span class="emphasis"><em>rightrecset</em></span> has few records, so little memory is used, allowing multiple lookup joins to be included in the same Thor subgraph.</td></tr><tr><td><span class="bold"><strong>GROUPED</strong></span></td><td>Specifies the same action as MANY LOOKUP but preserves grouping. Primarily used in the rapid Data Delivery Engine. Valid only for inner, LEFT OUTER, or LEFT ONLY <span class="emphasis"><em>jointypes</em></span>. The ATMOST, LIMIT, and KEEP options are supported in conjunction with GROUPED.</td></tr><tr><td><span class="bold"><strong>ALL</strong></span></td><td>Specifies the <span class="emphasis"><em>rightrecset</em></span> is a small file that can be fully copied to every node, which allows the compiler to ignore the lack of any "equality" portion to the condition, eliminating the "join too complex" error that the condition would normally produce. If an "equality" portion is present, the JOIN is internally executed as a MANY LOOKUP. The KEEP option is supported in conjunction with this option.</td></tr><tr><td><span class="bold"><strong>NOSORT</strong></span></td><td>Performs the JOIN without dynamically sorting the tables.</td></tr><tr><td><span class="emphasis"><em>which</em></span></td><td>Optional. The keywords LEFT or RIGHT to indicate the <span class="emphasis"><em>leftrecset</em></span> or <span class="emphasis"><em>rightrecset</em></span> has been previously sorted. If omitted, NOSORT assumes both the <span class="emphasis"><em>leftrecset</em></span> and <span class="emphasis"><em>rightrecset</em></span> have been previously sorted.</td></tr><tr><td><span class="bold"><strong>KEYED</strong></span></td><td>Specifies using indexed access into the <span class="emphasis"><em>rightrecset</em></span> (see INDEX).</td></tr><tr><td><span class="emphasis"><em>index</em></span></td><td>Optional. The attribute name of an INDEX into the <span class="emphasis"><em>rightrecset</em></span> for a full-keyed JOIN (see below). If omitted, indicates the <span class="emphasis"><em>rightrecset</em></span> will always be an INDEX (useful when the <span class="emphasis"><em>rightrecset</em></span> is passed in as a parameter to a function).</td></tr><tr><td><span class="bold"><strong>UNORDERED</strong></span></td><td>Optional. Specifies the KEYED JOIN operation does not preserve the sort order of the <span class="emphasis"><em>leftrecset</em></span>.</td></tr><tr><td><span class="bold"><strong>LOCAL</strong></span></td><td>Specifies the operation is performed on each supercomputer node independently, without requiring interaction with all other nodes to acquire data; the operation maintains the distribution of any previous DISTRIBUTE.</td></tr><tr><td><span class="bold"><strong>HASH</strong></span></td><td>Specifies implicit distribution of the <span class="emphasis"><em>leftrecset</em></span> and <span class="emphasis"><em>rightrecset</em></span> across the supercomputer nodes so each node can do its job with local data.</td></tr><tr><td><span class="bold"><strong>KEEP(n)</strong></span></td><td>Specifies the maximum number of matching records (n) to generate into the result set. If omitted, all matches are kept. This is useful where there may be many matching pairs and you need to limit the number in the result set. KEEP is not supported for RIGHT OUTER, RIGHT ONLY, LEFT ONLY, or FULL ONLY <span class="emphasis"><em>jointypes</em></span>.</td></tr><tr><td><span class="bold"><strong>ATMOST</strong></span></td><td>Specifies a maximum number of matching records which, if exceeded, eliminates all those matches from the result set. This is useful for situations where you need to eliminate all "too many matches" record pairs from the result set. ATMOST is not supported on RIGHT ONLY or RIGHT OUTER <span class="emphasis"><em>jointypes</em></span>. There are two forms: ATMOST(condition, n) &#8212; maximum is computed only for the condition. ATMOST(n) &#8212; maximum is computed for the entire <span class="emphasis"><em>joincondition</em></span>, unless KEYED is used in the <span class="emphasis"><em>joincondition</em></span>, in which case only the KEYED expressions are used. When ATMOST is specified (and the JOIN is not full or half-keyed), the <span class="emphasis"><em>joincondition</em></span> and condition may include string field comparisons that use string indexing with an asterisk as the upper bound, as in this example: J1 := JOIN(dsL,dsR, LEFT.name[1..*]=RIGHT.name[3..*] AND LEFT.val &lt; RIGHT.val, T(LEFT,RIGHT), ATMOST(LEFT.name[1..*]=RIGHT.name[3..*],3)); The asterisk indicates matching as many characters as necessary to reduce the number of candidate matches to below the ATMOST number (n).</td></tr><tr><td><span class="emphasis"><em>condition</em></span></td><td>A portion of the <span class="emphasis"><em>joincondition</em></span> expression.</td></tr><tr><td><span class="emphasis"><em>n</em></span></td><td>Specifies the maximum number of matches allowed.</td></tr><tr><td><span class="bold"><strong>LIMIT</strong></span></td><td>Specifies a maximum number of matching records which, if exceeded, either fails the job, or eliminates all those matches from the result set. This is useful for situations where you need to eliminate all "too many matches" record pairs from the result set. Typically used for KEYED and "half-keyed" joins (see below), LIMIT differs from ATMOST primarily by its affect on a LEFT OUTER join, in which a <span class="emphasis"><em>leftrecset</em></span> record with too many matching records would be treated as a non-match by ATMOST (the <span class="emphasis"><em>leftrecset</em></span> record would be in the output with no matching <span class="emphasis"><em>rightrecset</em></span> records), whereas LIMIT would either fail the job entirely, or SKIP the record (eliminating the <span class="emphasis"><em>leftrecset</em></span> record entirely from the output). If omitted, the default is LIMIT(10000); LIMIT(0) is unlimited.</td></tr><tr><td><span class="emphasis"><em>value</em></span></td><td>The maximum number of matches allowed.</td></tr><tr><td><span class="bold"><strong>SKIP</strong></span></td><td>Optional. Specifies eliminating the matching records that exceed the maximum value of the LIMIT result instead of failing the job.</td></tr><tr><td><span class="bold"><strong>SKEW</strong></span></td><td>Indicates that you know the data for this join will not be spread evenly across nodes (will be skewed after both files have been distributed based on the join <span class="emphasis"><em>condition</em></span>) and you choose to override the default by specifying your own limit value to allow the job to continue despite the skewing. Only valid on non-keyed joins (the KEYED option is not present and the <span class="emphasis"><em>rightrecset</em></span> is not an INDEX).</td></tr><tr><td><span class="emphasis"><em>limit</em></span></td><td>A value between zero (0) and one (1.0 = 100%) indicating the maximum percentage of skew to allow before the job fails (the default is 0.1 = 10%).</td></tr><tr><td><span class="emphasis"><em>target</em></span></td><td>Optional. A value between zero (0) and one (1.0 = 100%) indicating the desired maximum percentage of skew to allow (the default is 0.1 = 10%).</td></tr><tr><td><span class="bold"><strong>THRESHOLD</strong></span></td><td>Indicates the minimum size for a single part of either the <span class="emphasis"><em>leftrecset</em></span> or <span class="emphasis"><em>rightrecset</em></span> before the SKEW limit is enforced. Only valid on non-keyed joins (the KEYED option is not present and the <span class="emphasis"><em>rightrecset</em></span> is not an INDEX).</td></tr><tr><td><span class="emphasis"><em>size</em></span></td><td>An integer value indicating the minimum number of bytes for a single part.</td></tr><tr><td><span class="bold"><strong>PARALLEL</strong></span></td><td>Specifies the <span class="emphasis"><em>leftrecset</em></span> and <span class="emphasis"><em>rightrecset</em></span> should be read on separate threads to minimize latency.</td></tr></tbody></table></div><p>The following options are mutually exclusive and may only be used to the exclusion of the others in this list: PARTITION LEFT | PARTITION RIGHT | [MANY] LOOKUP | GROUPED | ALL | NOSORT | HASH</p><p>In addition to this list, the KEYED and LOCAL options are also mutually exclusive with the options listed above, but not to each other. When both KEYED and LOCAL options are specified, only the INDEX part(s) on each node are accessed by that node.</p><p>Typically, the <span class="emphasis"><em>leftrecset</em></span> should be larger than the <span class="emphasis"><em>rightrecset</em></span> to prevent skewing problems (because PARTITION LEFT is the default behavior). If the LOOKUP or ALL options are specified, the <span class="emphasis"><em>rightrecset</em></span> <span class="underline">must</span> be small enough to be loaded into memory on every node, and the operation is then implicitly LOCAL. The ALL option is impractical if the <span class="emphasis"><em>rightrecset</em></span> is larger than a few thousand records (due to the number of comparisons required). The size of the <span class="emphasis"><em>rightrecset</em></span> is irrelevant in the case of "half-keyed" and "full-keyed" JOINs (see the Keyed Join discussion below).</p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="bk01ch10s60s02.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="bk01ch10s60.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="bk01ch10s60s04.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Matching Logic - JOIN&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Keyed Joins</td></tr></table></div></body></html>