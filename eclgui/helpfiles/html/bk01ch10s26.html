<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>DEDUP</title><link rel="stylesheet" href="eclipsehelp.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.1"><link rel="home" href="index.html" title="ECL Reference"><link rel="up" href="bk01ch10.html" title="Built-in Functions and Actions"><link rel="prev" href="bk01ch10s25.html" title="CRON"><link rel="next" href="bk01ch10s26s01.html" title="Complex Record Set Conditions"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">DEDUP</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="bk01ch10s25.html">Prev</a>&nbsp;</td><th width="60%" align="center"><span class="bold"><strong>Built-in Functions and Actions</strong></span></th><td width="20%" align="right">&nbsp;<a accesskey="n" href="bk01ch10s26s01.html">Next</a></td></tr></table><hr></div><div class="sect1" title="DEDUP"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="DEDUP"></a>DEDUP<a class="indexterm" name="d4e6294"></a></h2></div></div></div><p><span class="bold"><strong>DEDUP<a class="indexterm" name="d4e6298"></a>(</strong></span><span class="emphasis"><em>recordset </em></span><span class="bold"><strong>[,</strong></span><span class="emphasis"><em> condition </em></span><span class="bold"><strong>[, ALL<a class="indexterm" name="d4e6304"></a>[, HASH<a class="indexterm" name="d4e6306"></a>]] [, KEEP<a class="indexterm" name="d4e6308"></a> </strong></span><span class="emphasis"><em>n </em></span><span class="bold"><strong>] [</strong></span>,<span class="emphasis"><em> keeper </em></span><span class="bold"><strong>] ] [</strong></span><span class="emphasis"><em>, </em></span><span class="bold"><strong>LOCAL<a class="indexterm" name="d4e6316"></a>])</strong></span></p><div class="informaltable"><table border="0"><colgroup><col width="13%"><col width="87%"></colgroup><tbody><tr><td><span class="emphasis"><em>recordset</em></span></td><td>The set of records to process, typically sorted in the same order that the expression will test. This may be the name of a dataset or derived record set, or any expression that results in a derived record set.</td></tr><tr><td><span class="emphasis"><em>condition</em></span></td><td>Optional. A comma-delimited list of expressions or key fields in the recordset that defines &#8220;duplicate&#8221; records. The keywords LEFT and RIGHT may be used as dataset qualifiers for fields in the recordset. If the condition is omitted, every recordset field becomes the match condition. You may use the keyword RECORD (or WHOLE RECORD) to indicate all fields in that structure, and/or you may use the keyword EXCEPT to list non-dedup fields in the structure.</td></tr><tr><td><span class="bold"><strong>ALL</strong></span></td><td>Optional. Matches the condition against all records, not just adjacent records. This option may change the output order of the resulting records.</td></tr><tr><td><span class="bold"><strong>HASH</strong></span></td><td>Optional. Specifies the ALL operation is performed using hash tables.</td></tr><tr><td><span class="bold"><strong>KEEP</strong></span></td><td>Optional. Specifies keeping n number of duplicate records. If omitted, the default behavior is to KEEP 1. Not valid with the ALL option present.</td></tr><tr><td><span class="emphasis"><em>n</em></span></td><td>The number of duplicate records to keep.</td></tr><tr><td><span class="emphasis"><em>keeper</em></span></td><td>Optional. The keywords LEFT or RIGHT. LEFT (the default, if omitted) keeps the first record encountered and RIGHT keeps the last.</td></tr><tr><td><span class="bold"><strong>LOCAL</strong></span></td><td>Optional. Specifies the operation is performed on each supercomputer node independently, without requiring interaction with all other nodes to acquire data; the operation maintains the distribution of any previous DISTRIBUTE.</td></tr><tr><td>Return:</td><td>DEDUP returns a set of records.</td></tr></tbody></table></div><p>The <span class="bold"><strong>DEDUP</strong></span> function evaluates the <span class="emphasis"><em>recordset</em></span> for duplicate records, as defined by the <span class="emphasis"><em>condition</em></span> parameter, and returns a unique return set. This is similar to the DISTINCT statement in SQL<a class="indexterm" name="d4e6363"></a>. The <span class="emphasis"><em>recordset</em></span> should be sorted, unless ALL is specified.</p><p>If a <span class="emphasis"><em>condition </em></span>parameter is a single value (<span class="emphasis"><em>field</em></span>), DEDUP does a simple field-level de-dupe equivalent to LEFT.<span class="emphasis"><em>field</em></span>=RIGHT.<span class="emphasis"><em>field</em></span>. The <span class="emphasis"><em>condition </em></span>is evaluated for each pair of adjacent records in the record set. If the <span class="emphasis"><em>condition </em></span>returns TRUE, the <span class="emphasis"><em>keeper</em></span> record is kept and the other removed.</p><p>The <span class="bold"><strong>ALL</strong></span> option means that every record pair is evaluated rather than only those pairs adjacent to each other, irrespective of sort order. The evaluation is such that, for records 1, 2, 3, 4, the record pairs that are compared to each other are:</p><p>(1,2),(1,3),(1,4),(2,1),(2,3),(2,4),(3,1),(3,2),(3,4),(4,1),(4,2),(4,3)</p><p>This means two compares happen for each pair, allowing the <span class="emphasis"><em>condition </em></span>to be non-commutative.</p><p><span class="bold"><strong>KEEP</strong></span> <span class="emphasis"><em>n</em></span> effectively means leaving <span class="emphasis"><em>n</em></span> records of each duplicate type. This is useful for sampling. The <span class="bold"><strong>LEFT</strong></span> <span class="emphasis"><em>keeper</em></span> value (implicit if neither LEFT nor RIGHT are specified) means that if the left and right records meet the de-dupe criteria (that is, they &#8220;match&#8221;), the left record is kept. If the <span class="bold"><strong>RIGHT</strong></span> <span class="emphasis"><em>keeper</em></span> appears instead, the right is kept. In both cases, the next comparison involves the de-dupe survivor; in this way, many duplicate records can collapse into one.</p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="bk01ch10s25.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="bk01ch10.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="bk01ch10s26s01.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">CRON&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Complex Record Set Conditions</td></tr></table></div></body></html>